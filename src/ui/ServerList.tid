title: $:/plugins/linonetwo/tw-mobile-sync/ui/ServerList
type: text/vnd.tiddlywiki

<div class="tw-mobile-sync-server-list">
  <$list filter="[prefix[$:/state/tw-mobile-sync/server/]] -[[$:/state/tw-mobile-sync/server/new]] -[[$:/state/tw-mobile-sync/server/new/scan-qr-widget-open]]">
    <div class="tw-mobile-sync-server-list-item">
      {{||$:/plugins/linonetwo/tw-mobile-sync/ui/ServerItemViewTemplateBasic}}
      {{||$:/plugins/linonetwo/tw-mobile-sync/ui/ServerItemCopyTemplate}}
    </div>
  </$list>
</div>

<div style="display: flex; flex-direction: row;">
  <div class="tw-mobile-sync-new-server-field-fields-container-outer">
    <fieldset>
      <legend>智能识别黏贴框 Smart Identify Sticky Box</legend>

      <div class="tw-mobile-sync-new-server-field-fields-container">
        <$edit-text tiddler="$:/state/tw-mobile-sync/server/new" field="text" default=""/>

        <div class="tw-mobile-sync-new-server-field-fields-buttons">
          <$button>
            智能识别 Smart Identify
            <$action-sendmessage $message="tw-mobile-sync-smart-recognize-ip-address" from="$:/state/tw-mobile-sync/server/new"/>
          </$button>

          <$reveal type="nomatch" state="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" text="yes">
            <$button>
              扫二维码 Scan QR
              <$action-setfield $tiddler="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" text="yes" />
            </$button>
          </$reveal>
          <$reveal type="match" state="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" text="yes">
            <$button>
              停止扫码 Stop Scan
              <$action-setfield $tiddler="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" text="no" />
            </$button>
          </$reveal>
        </div>
      </div>

      <$reveal type="match" state="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" text="yes">
        <$ScanQRWidget outputTiddler="$:/state/tw-mobile-sync/server/new" stopOnDetect="yes" stateTiddler="$:/state/tw-mobile-sync/server/new/scan-qr-widget-open" />
      </$reveal>

    </fieldset>
    <fieldset>
      <legend>服务器名 Server Name</legend>
      <$edit-text tiddler="$:/state/tw-mobile-sync/server/new" field="name" default="" />
    </fieldset>
    <fieldset>
      <legend>服务器IP Server IP</legend>
      <$edit-text tiddler="$:/state/tw-mobile-sync/server/new" field="ipAddress" default="" />
    </fieldset>
    <fieldset>
      <legend>服务器端口 Server Port</legend>
      <$edit-text tiddler="$:/state/tw-mobile-sync/server/new" field="port" default="" />
    </fieldset>
  </div>
  <$button style="width: 160px; margin-top: 10px;">
    <div>新增服务器</div>
    <div>Add New</div>
    <$action-createtiddler
      $basetitle={{{ [<now "YYYY-MM-DD-0hh0mm0ss">] +[addprefix[$:/state/tw-mobile-sync/server/]] }}}
      text="offline"
      name={{$:/state/tw-mobile-sync/server/new!!name}}
      caption={{$:/state/tw-mobile-sync/server/new!!name}}
      ipAddress={{$:/state/tw-mobile-sync/server/new!!ipAddress}}
      port={{$:/state/tw-mobile-sync/server/new!!port}}
      lastSync=<<now "[UTC]YYYY0MM0DD0hh0mm0ssXXX">>
    />
    <$action-setfield $tiddler="$:/state/tw-mobile-sync/server/new" text="" name="" ipAddress="" port="" />
  </$button>
</div>

<div>
  {{$:/plugins/linonetwo/tw-mobile-sync/ui/DownloadFullHtml}}
</div>
